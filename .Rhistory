easy_data %>%
median_qi(rana_blairi_yankton_1+rana_blairi_yankton_2)
easy_data %>%
median_qi(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)
easy_data %>%
median_qi(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2)
#Calculating the differences between species
species_diff <- easy_data %>%
mutate(catesbeiana_woodhousii=(rana_catesbeiana_cold_brook_lake-(anaxyrus_woodhousii_NAB_2 + anaxyrus_woodhousii_cottonwood_springs_lake + anaxyrus_woodhousii_yankton_2))) %>%
mutate(catesbeiana_pipiens=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(catesbeiana_blairi=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(catesbeiana_blanchardi=(rana_catesbeiana_cold_brook_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(pipiens_blairi=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(pipiens_woodhousii=(rana_pipiens_lost_lake-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(pipiens_blanchardi=(rana_pipiens_lost_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(blairi_woodhousii=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(blairi_blanchardi=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blanchardi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blairi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(woodhousii_catesbeiana=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_catesbeiana_cold_brook_lake)) %>%
mutate(woodhousii_pipiens=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_pipiens_lost_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
species_diff %>%
median_qi(catesbeiana_woodhousii)
species_diff %>%
median_qi(catesbeiana_blairi)
species_diff %>%
median_qi(catesbeiana_pipiens)
species_diff %>%
median_qi(catesbeiana_blanchardi)
species_diff %>%
median_qi(pipiens_blairi)
species_diff %>%
median_qi(pipiens_woodhousii)
species_diff %>%
median_qi(pipiens_blanchardi)
species_diff %>%
median_qi(blairi_woodhousii)
species_diff %>%
median_qi(blairi_blanchardi)
#Mean diffs
species_diff %>%
mean_qi(woodhousii_blairi)
species_diff %>%
mean_qi(woodhousii_catesbeiana)
species_diff %>%
mean_qi(woodhousii_pipiens)
species_diff %>%
mean_qi(woodhousii_blanchardi)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first species has a greater quantity of virus than the second species.
species_diff %>%
summarize(higher=sum(catesbeiana_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_pipiens>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_catesbeiana>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_pipiens>0)/nrow(.))
#Now to calculate the differences by sampling site
site_diff <- easy_data %>%
mutate(cold_lost=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(cold_yank1=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(cold_yank2=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(cold_NAB=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(cold_cottonwood=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(lost_yank1=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(lost_yank2=(rana_pipiens_lost_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(lost_NAB=(rana_pipiens_lost_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(lost_cottonwood=(rana_pipiens_lost_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank1_yank2=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(yank1_NAB=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank1_cottonwood=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank2_NAB=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank2_cottonwood=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(NAB_cottonwood=(anaxyrus_woodhousii_NAB_2-anaxyrus_woodhousii_cottonwood_springs_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
site_diff %>%
median_qi(cold_lost)
site_diff %>%
median_qi(cold_yank1)
site_diff %>%
median_qi(cold_yank2)
site_diff %>%
median_qi(cold_NAB)
site_diff %>%
median_qi(cold_cottonwood)
site_diff %>%
median_qi(lost_yank1)
site_diff %>%
median_qi(lost_yank2)
site_diff %>%
median_qi(lost_NAB)
site_diff %>%
median_qi(lost_cottonwood)
site_diff %>%
median_qi(yank1_yank2)
site_diff %>%
median_qi(yank1_NAB)
site_diff %>%
median_qi(yank1_cottonwood)
site_diff %>%
median_qi(yank2_NAB)
site_diff %>%
median_qi(yank2_cottonwood)
site_diff %>%
median_qi(NAB_cottonwood)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first site has a greater quantity of virus than the second site.
site_diff %>%
summarize(higher=sum(cold_lost>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(NAB_cottonwood>0)/nrow(.))
#Difference between species at Yankton 1 and Yankton 2
site_based_diff <- easy_data %>%
mutate(blanchardi_blairi_yank1=(acris_blanchardi_yankton_1-rana_blairi_yankton_1)) %>%
mutate(woodhousii_blairi_yank2=(anaxyrus_woodhousii_yankton_2-rana_blairi_yankton_2)) %>%
mutate(blanchardi_woodhousii_yank2=(anaxyrus_woodhousii_yankton_2-acris_blanchardi_yankton_2))
#Calculating median difference in average ranavirus copies between species at yank1 and yank2
site_based_diff %>%
mean_qi(blanchardi_blairi_yank1)
site_based_diff %>%
mean_qi(woodhousii_blairi_yank2)
site_based_diff %>%
mean_qi(blanchardi_woodhousii_yank2)
#Probability that the first is greater than the second
site_based_diff %>%
summarize(higher=(sum(blanchardi_blairi_yank1>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(woodhousii_blairi_yank2>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(blanchardi_woodhousii_yank2>0))/nrow(.))
get_prior((bf(virus_copies ~ 1 + site + (1|species),hu ~ 1 + site)), data=site_data, family=hurdle_gamma(link="log"))
#model
species_site_model <- brm(bf(virus_copies ~ 1 + site + (1|species), # varying intercept by species this is a random effect
hu ~ 1 + site),     #This line is added to model the probability of detecting the virus, this makes the detection probability unique for each site.
family=hurdle_gamma(link="log"),
data=site_data,
prior=c(prior(normal(0.8, 4), class="b"),
prior(normal(0.5, 3), class="Intercept"),
prior(normal(-0.5, 0.5), class = "Intercept", dpar = "hu"),
prior(normal(-0.5, 0.5), class = "b", dpar = "hu")),
# sample_prior="only",
iter=2000, chains=3,
file="Models/species_site_model.rds",
file_refit="on_change")
pp_check(species_site_model, type="stat_grouped", group="species")
#Mean ranavirus copies for each species at each site
summarize(posts_site, mean=mean(.epred))
easy_data %>%
median_qi(rana_catesbeiana_cold_brook_lake)
easy_data %>%
median_qi(rana_pipiens_lost_lake)
easy_data %>%
median_qi(rana_blairi_yankton_1+rana_blairi_yankton_2)
easy_data %>%
median_qi(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)
easy_data %>%
median_qi(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2)
species_diff %>%
median_qi(catesbeiana_woodhousii)
species_diff %>%
median_qi(catesbeiana_blairi)
species_diff %>%
median_qi(catesbeiana_pipiens)
species_diff %>%
median_qi(catesbeiana_blanchardi)
species_diff %>%
median_qi(pipiens_blairi)
species_diff %>%
median_qi(pipiens_woodhousii)
species_diff %>%
median_qi(pipiens_blanchardi)
species_diff %>%
median_qi(blairi_woodhousii)
species_diff %>%
median_qi(blairi_blanchardi)
species_diff %>%
summarize(higher=sum(catesbeiana_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_pipiens>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_catesbeiana>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_pipiens>0)/nrow(.))
#model
species_site_model <- brm(bf(virus_copies ~ 1 + site + (1|species), # varying intercept by species this is a random effect
hu ~ 1 + site),     #This line is added to model the probability of detecting the virus, this makes the detection probability unique for each site.
family=hurdle_gamma(link="log"),
data=site_data,
prior=c(prior(normal(0.8, 2), class="b"),
prior(normal(0.5, 2), class="Intercept"),
prior(normal(-0.5, 0.5), class = "Intercept", dpar = "hu"),
prior(normal(-0.5, 0.5), class = "b", dpar = "hu")),
# sample_prior="only",
iter=4000, chains=4,
file="Models/species_site_model.rds",
file_refit="on_change")
saveRDS(species_site_model, "Models/species_site_model.rds")
species_site_model#call the model to view stats
#Posterior predictive check
pp_check(species_site_model, type="stat_grouped", group="site")
pp_check(species_site_model, type="stat_grouped", group="species")
#Data for plotting
cond_data_site <- distinct(species_site_model$data %>% select(-virus_copies))
posts_site <- add_epred_draws(species_site_model, newdata=cond_data_site)
#Plot looking at the copies of ranavirus on the log scale based on species, colored by site, using the corrected virus value calculated by multiplying the probability of detection by the number of virus copies.
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=site_data, aes(y=virus_copies),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
ggsave("site_species_interaction_plot.jpg", plot=species_site_plot,width=6, height=4, dpi=600)
ggsave("site_species_interaction_plot.jpg", plot=species_site_plot,width=6, height=4, dpi=600)
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus_copies),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
ggsave("species_plot.jpg", plot=species_plot, width=6, height=4, dpi=600)
#Plot looking at the average copies of ranavirus on the log scale based on site
site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred))+
geom_violin(fill='#A4A4A4')+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus_copies),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(angle=30, hjust=1))
ggsave("site_plot.jpg", plot=site_plot, width=6, height=4, dpi=600)
species_site_plot
species_plot
site_plot
#Mean ranavirus copies for each species at each site
summarize(posts_site, mean=mean(.epred))
#Changing data format so that I can calculate the values I need from the posterior distribution
easy_data <- posts_site %>%
select(site, species, .draw,.row, .epred) %>%
ungroup() %>%
pivot_wider(id_cols=c(site, .draw),
names_from=species,
values_from=(.epred)) %>%
pivot_wider(id_cols=.draw,
names_from=site,
values_from=c("rana_catesbeiana", "rana_pipiens", "rana_blairi", "anaxyrus_woodhousii", "acris_blanchardi")) %>%
pivot_longer(cols=(-.draw),
names_to="condition",
values_to="virus") %>%
na.omit() %>%
group_by(condition) %>%
pivot_wider(id_cols=.draw,
names_from=condition,
values_from=virus) %>%
view()
easy_data %>%
median_qi(rana_catesbeiana_cold_brook_lake)
easy_data %>%
median_qi(rana_pipiens_lost_lake)
easy_data %>%
median_qi(rana_blairi_yankton_1+rana_blairi_yankton_2)
easy_data %>%
median_qi(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)
easy_data %>%
median_qi(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2)
species_diff <- easy_data %>%
mutate(catesbeiana_woodhousii=(rana_catesbeiana_cold_brook_lake-(anaxyrus_woodhousii_NAB_2 + anaxyrus_woodhousii_cottonwood_springs_lake + anaxyrus_woodhousii_yankton_2))) %>%
mutate(catesbeiana_pipiens=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(catesbeiana_blairi=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(catesbeiana_blanchardi=(rana_catesbeiana_cold_brook_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(pipiens_blairi=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(pipiens_woodhousii=(rana_pipiens_lost_lake-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(pipiens_blanchardi=(rana_pipiens_lost_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(blairi_woodhousii=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(blairi_blanchardi=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blanchardi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blairi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(woodhousii_catesbeiana=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_catesbeiana_cold_brook_lake)) %>%
mutate(woodhousii_pipiens=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_pipiens_lost_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
species_diff %>%
median_qi(catesbeiana_woodhousii)
species_diff %>%
median_qi(catesbeiana_blairi)
species_diff %>%
median_qi(catesbeiana_pipiens)
species_diff %>%
median_qi(catesbeiana_blanchardi)
species_diff %>%
median_qi(pipiens_blairi)
species_diff %>%
median_qi(pipiens_woodhousii)
species_diff %>%
median_qi(pipiens_blanchardi)
species_diff %>%
median_qi(blairi_woodhousii)
species_diff %>%
median_qi(blairi_blanchardi)
#Mean diffs
species_diff %>%
mean_qi(woodhousii_blairi)
species_diff %>%
mean_qi(woodhousii_catesbeiana)
species_diff %>%
mean_qi(woodhousii_pipiens)
species_diff %>%
mean_qi(woodhousii_blanchardi)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first species has a greater quantity of virus than the second species.
species_diff %>%
summarize(higher=sum(catesbeiana_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_pipiens>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_catesbeiana>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_pipiens>0)/nrow(.))
#Now to calculate the differences by sampling site
site_diff <- easy_data %>%
mutate(cold_lost=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(cold_yank1=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(cold_yank2=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(cold_NAB=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(cold_cottonwood=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(lost_yank1=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(lost_yank2=(rana_pipiens_lost_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(lost_NAB=(rana_pipiens_lost_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(lost_cottonwood=(rana_pipiens_lost_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank1_yank2=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(yank1_NAB=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank1_cottonwood=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank2_NAB=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank2_cottonwood=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(NAB_cottonwood=(anaxyrus_woodhousii_NAB_2-anaxyrus_woodhousii_cottonwood_springs_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
site_diff %>%
median_qi(cold_lost)
site_diff %>%
median_qi(cold_yank1)
site_diff %>%
median_qi(cold_yank2)
site_diff %>%
median_qi(cold_NAB)
site_diff %>%
median_qi(cold_cottonwood)
site_diff %>%
median_qi(lost_yank1)
site_diff %>%
median_qi(lost_yank2)
site_diff %>%
median_qi(lost_NAB)
site_diff %>%
median_qi(lost_cottonwood)
site_diff %>%
median_qi(yank1_yank2)
site_diff %>%
median_qi(yank1_NAB)
site_diff %>%
median_qi(yank1_cottonwood)
site_diff %>%
median_qi(yank2_NAB)
site_diff %>%
median_qi(yank2_cottonwood)
site_diff %>%
median_qi(NAB_cottonwood)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first site has a greater quantity of virus than the second site.
site_diff %>%
summarize(higher=sum(cold_lost>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(NAB_cottonwood>0)/nrow(.))
#Difference between species at Yankton 1 and Yankton 2
site_based_diff <- easy_data %>%
mutate(blanchardi_blairi_yank1=(acris_blanchardi_yankton_1-rana_blairi_yankton_1)) %>%
mutate(woodhousii_blairi_yank2=(anaxyrus_woodhousii_yankton_2-rana_blairi_yankton_2)) %>%
mutate(blanchardi_woodhousii_yank2=(anaxyrus_woodhousii_yankton_2-acris_blanchardi_yankton_2))
#Calculating median difference in average ranavirus copies between species at yank1 and yank2
site_based_diff %>%
mean_qi(blanchardi_blairi_yank1)
site_based_diff %>%
mean_qi(woodhousii_blairi_yank2)
site_based_diff %>%
mean_qi(blanchardi_woodhousii_yank2)
#Probability that the first is greater than the second
site_based_diff %>%
summarize(higher=(sum(blanchardi_blairi_yank1>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(woodhousii_blairi_yank2>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(blanchardi_woodhousii_yank2>0))/nrow(.))
site_name <- data.frame(site=c("cold_brook", "cottonwood_springs", "lost_lake", "NAB_2", "yankton_1", "yankton_2", "acheson", "buffalo_lake", "gold_run_creek", "habeger", "horsethief", "iron_creek_lake", "long_lake", "mitchell_lake", "pettigrew", "roubaix_lake", "sylvan_lake"))
prevalence_rate <- data.frame(prevalence=c(0.06666667, 0.7692308, 0.625, 0.8571429,0.8235294, 0.9411765, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0))
prevalence_data_site <- cbind(site_name, prevalence_rate) %>%
view()
prevalence_data_site
(0.067+0.7692+0.625+0.857+0.824+0.941)/6
6/17
(0.067+0.7692+0.625+0.857+0.824+0.941)/6
(0.6805333+0+0+0+0+0+0+0+0+0+0+0)/17
(0.067+0.7692+0.625+0.857+0.824+0.941+0+0+0+0+0+0+0+0+0+0+0)/17
