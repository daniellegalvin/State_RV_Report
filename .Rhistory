mutate(prevalence=((sum(positive_status)/(sum(singles)))*100))
#Adding 0.000001 to all average virus values so that I have no zero values and am able to use the Gamma distribution for my model
new_data <- site_based_pos %>%
mutate(virus=(average_virus+0.1))
#model
species_site_model <- brm(virus ~ 1+ site*species,
family=Gamma(link="log"),
data=new_data %>% filter(virus>0.1),
prior=c(prior(normal(0, 0.5), class="b"),
prior(normal(0.5, 2), class="Intercept")),
#sample_prior="only",
iter=2000, chains=4,
file="Models/species_site_model.rds",
file_refit="on_change")
species_site_model <- update(species_site_model, iter=2000, chains=4)#update chains and iterations
species_site_model#call the model to view stats
saveRDS(species_site_model, "Models/species_site_model.rds")
#Conditional effects plot
plot(conditional_effects(species_site_model, points=T))
#Data for plotting
cond_data_site <- distinct(species_site_model$data %>% select(-virus))
posts_site <- add_epred_draws(species_site_model, newdata=cond_data_site)
#Plot looking at the average copies of ranavirus on the log scale based on species, colored by site
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
species_site_plot
ggsave("site_species_interaction_plot.jpg", plot=species_site_plot,width=6, height=4, dpi=600)
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin(fill='#A4A4A4')+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
ggsave("species_plot.jpg", plot=species_plot, width=6, height=4, dpi=600)
#Plot looking at the average copies of ranavirus on the log scale based on site
site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred))+
geom_violin(fill='#A4A4A4')+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(angle=30, hjust=1))
site_plot
ggsave("site_plot.jpg", plot=site_plot, width=6, height=4, dpi=600)
#posterior predictive check graphs
pp_check(species_site_model, type="stat_grouped", group="species")
pp_check(species_site_model, type="stat_grouped", group="site")
pp_check(species_site_model, type="boxplot")
#Mean ranavirus copies for each species at each site
summarize(posts_site, mean=mean(.epred))
#Changing data format so that I can calculate the values I need from the posterior distribution
easy_data <- posts_site %>%
select(site, species, .draw,.row, .epred) %>%
ungroup() %>%
pivot_wider(id_cols=c(site, .draw),
names_from=species,
values_from=(.epred)) %>%
pivot_wider(id_cols=.draw,
names_from=site,
values_from=c("rana_catesbeiana", "rana_pipiens", "rana_blairi", "anaxyrus_woodhousii", "acris_blanchardi")) %>%
pivot_longer(cols=(-.draw),
names_to="condition",
values_to="virus") %>%
na.omit() %>%
group_by(condition) %>%
pivot_wider(id_cols=.draw,
names_from=condition,
values_from=virus) %>%
view()
#Medians with 95% CI values for each species (combining sites)
easy_data %>%
median_qi(rana_catesbeiana_cold_brook_lake)
easy_data %>%
median_qi(rana_pipiens_lost_lake)
easy_data %>%
median_qi(rana_blairi_yankton_1+rana_blairi_yankton_2)
easy_data %>%
median_qi(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)
easy_data %>%
median_qi(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2)
#Calculating the differences between species
species_diff <- easy_data %>%
mutate(catesbeiana_woodhousii=(rana_catesbeiana_cold_brook_lake-(anaxyrus_woodhousii_NAB_2 + anaxyrus_woodhousii_cottonwood_springs_lake + anaxyrus_woodhousii_yankton_2))) %>%
mutate(catesbeiana_pipiens=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(catesbeiana_blairi=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(catesbeiana_blanchardi=(rana_catesbeiana_cold_brook_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(pipiens_blairi=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(pipiens_woodhousii=(rana_pipiens_lost_lake-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(pipiens_blanchardi=(rana_pipiens_lost_lake-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(blairi_woodhousii=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2))) %>%
mutate(blairi_blanchardi=((rana_blairi_yankton_1+rana_blairi_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blanchardi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(acris_blanchardi_yankton_1+acris_blanchardi_yankton_2))) %>%
mutate(woodhousii_blairi=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-(rana_blairi_yankton_1+rana_blairi_yankton_2))) %>%
mutate(woodhousii_catesbeiana=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_catesbeiana_cold_brook_lake)) %>%
mutate(woodhousii_pipiens=((anaxyrus_woodhousii_NAB_2+anaxyrus_woodhousii_cottonwood_springs_lake+anaxyrus_woodhousii_yankton_2)-rana_pipiens_lost_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
species_diff %>%
median_qi(catesbeiana_woodhousii)
species_diff %>%
median_qi(catesbeiana_blairi)
species_diff %>%
median_qi(catesbeiana_pipiens)
species_diff %>%
median_qi(catesbeiana_blanchardi)
species_diff %>%
median_qi(pipiens_blairi)
species_diff %>%
median_qi(pipiens_woodhousii)
species_diff %>%
median_qi(pipiens_blanchardi)
species_diff %>%
median_qi(blairi_woodhousii)
species_diff %>%
median_qi(blairi_blanchardi)
#Mean diffs
species_diff %>%
mean_qi(woodhousii_blairi)
species_diff %>%
mean_qi(woodhousii_catesbeiana)
species_diff %>%
mean_qi(woodhousii_pipiens)
species_diff %>%
mean_qi(woodhousii_blanchardi)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first species has a greater quantity of virus than the second species.
species_diff %>%
summarize(higher=sum(catesbeiana_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_pipiens>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(catesbeiana_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(pipiens_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_woodhousii>0)/nrow(.))
species_diff %>%
summarize(higher=sum(blairi_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blanchardi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_blairi>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_catesbeiana>0)/nrow(.))
species_diff %>%
summarize(higher=sum(woodhousii_pipiens>0)/nrow(.))
#Now to calculate the differences by sampling site
site_diff <- easy_data %>%
mutate(cold_lost=(rana_catesbeiana_cold_brook_lake-rana_pipiens_lost_lake)) %>%
mutate(cold_yank1=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(cold_yank2=(rana_catesbeiana_cold_brook_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(cold_NAB=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(cold_cottonwood=(rana_catesbeiana_cold_brook_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(lost_yank1=(rana_pipiens_lost_lake-(rana_blairi_yankton_1+acris_blanchardi_yankton_1))) %>%
mutate(lost_yank2=(rana_pipiens_lost_lake-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(lost_NAB=(rana_pipiens_lost_lake-anaxyrus_woodhousii_NAB_2)) %>%
mutate(lost_cottonwood=(rana_pipiens_lost_lake-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank1_yank2=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-(rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2))) %>%
mutate(yank1_NAB=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank1_cottonwood=((rana_blairi_yankton_1+acris_blanchardi_yankton_1)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(yank2_NAB=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_NAB_2)) %>%
mutate(yank2_cottonwood=((rana_blairi_yankton_2+anaxyrus_woodhousii_yankton_2+acris_blanchardi_yankton_2)-anaxyrus_woodhousii_cottonwood_springs_lake)) %>%
mutate(NAB_cottonwood=(anaxyrus_woodhousii_NAB_2-anaxyrus_woodhousii_cottonwood_springs_lake))
#Calculating the median ranavirus copies and the 95% credible interval. There is a 95% probability that the values range from blank to blank with a median of blank.
site_diff %>%
median_qi(cold_lost)
site_diff %>%
median_qi(cold_yank1)
site_diff %>%
median_qi(cold_yank2)
site_diff %>%
median_qi(cold_NAB)
site_diff %>%
median_qi(cold_cottonwood)
site_diff %>%
median_qi(lost_yank1)
site_diff %>%
median_qi(lost_yank2)
site_diff %>%
median_qi(lost_NAB)
site_diff %>%
median_qi(lost_cottonwood)
site_diff %>%
median_qi(yank1_yank2)
site_diff %>%
median_qi(yank1_NAB)
site_diff %>%
median_qi(yank1_cottonwood)
site_diff %>%
median_qi(yank2_NAB)
site_diff %>%
median_qi(yank2_cottonwood)
site_diff %>%
median_qi(NAB_cottonwood)
#Calculating the probability that there is a difference between groups. Calculating the probability that the first site has a greater quantity of virus than the second site.
site_diff %>%
summarize(higher=sum(cold_lost>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(cold_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank1>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(lost_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_yank2>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank1_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_NAB>0)/nrow(.))
site_diff %>%
summarize(higher=sum(yank2_cottonwood>0)/nrow(.))
site_diff %>%
summarize(higher=sum(NAB_cottonwood>0)/nrow(.))
#Difference between species at Yankton 1 and Yankton 2
site_based_diff <- easy_data %>%
mutate(blanchardi_blairi_yank1=(acris_blanchardi_yankton_1-rana_blairi_yankton_1)) %>%
mutate(woodhousii_blairi_yank2=(anaxyrus_woodhousii_yankton_2-rana_blairi_yankton_2)) %>%
mutate(blanchardi_woodhousii_yank2=(anaxyrus_woodhousii_yankton_2-acris_blanchardi_yankton_2))
#Calculating median difference in average ranavirus copies between species at yank1 and yank2
site_based_diff %>%
mean_qi(blanchardi_blairi_yank1)
site_based_diff %>%
mean_qi(woodhousii_blairi_yank2)
site_based_diff %>%
mean_qi(blanchardi_woodhousii_yank2)
#Probability that the first is greater than the second
site_based_diff %>%
summarize(higher=(sum(blanchardi_blairi_yank1>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(woodhousii_blairi_yank2>0))/nrow(.))
site_based_diff %>%
summarize(higher=(sum(blanchardi_woodhousii_yank2>0))/nrow(.))
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin()+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin(fill=c("003300", "339900", "FFFF00", "0000FF", "000033"))+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin()+
scale_fill_manual(values=c("003300", "339900", "FFFF00", "0000FF", "000033"))+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin()+
scale_fill_manual(values=c("#246106", "339900", "FFFF00", "0000FF", "000033"))+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin()+
scale_fill_manual(values=c("#3003300", "#339900", "#FFFF00", "#0000FF", "#000033"))+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin(trim=FALSE)+
scale_fill_manual(values=c("#3003300", "#339900", "#FFFF00", "#0000FF", "#000033"))+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin()+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))+
scale_fill_manual(values=c("#3003300", "#339900", "#FFFF00", "#0000FF", "#000033"))
species_plot
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin(fill=species)+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred))+
geom_violin(fill="species")+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
ggsave("species_plot.jpg", plot=species_plot, width=6, height=4, dpi=600)
#Plot looking at the average copies of ranavirus on the log scale based on species
species_plot <- posts_site %>%
ggplot(aes(x=species, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1, alpha=0.6, outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Species")+
theme(axis.text.x=element_text(angle=30, hjust=1))
species_plot
library(tidyverse)
library(brms)
library(readxl)
library(tidybayes)
#Load the data
data <- read_excel("2021_State_Ranavirus_Data.xlsx",
col_types = c("text", "text", "text",
"text", "text", "text", "numeric",
"text", "text", "text", "numeric",
"numeric", "numeric", "skip", "text"))
#Adding a column to the data where positives are given a 1, negatives a 0, then selecting the necessary columns and calculating the average copies of virus per individual
site_based_pos <- data %>%
mutate(positive_status=case_when(result=="positive" ~ 1,
TRUE ~ 0))%>%
#filter(value_1>0) %>%
select(sample_label, site, side_of_state, species, value_1, value_2, value_3, positive_status) %>%
group_by(sample_label) %>%
mutate(average_virus=mean(c(value_1, value_2, value_3))) %>%
mutate(singles=1)
#Doing the same as above but now incorporating development stage
develop <- data %>%
mutate(positive_status=case_when(result=="positive" ~ 1,
TRUE ~ 0))%>%
select(sample_label, site, side_of_state, species, stage, value_1, value_2, value_3, positive_status) %>%
group_by(sample_label) %>%
mutate(average_virus=mean(c(value_1, value_2, value_3))) %>%
mutate(singles=1) %>%
mutate(stage=case_when(stage=="adult"~"adult",
TRUE ~ "juvenile"))
#Total positive individuals by site
total_pos <- site_based_pos %>%
group_by(site) %>%
mutate(total_positive=sum(positive_status)) %>%
mutate(total_individuals=sum(singles)) %>%
ungroup()
#Prevalence by site from scratch
prev_site <- total_pos %>%
group_by(site) %>%
mutate(prevalence=((sum(positive_status)/(sum(singles)))*100))
#Total positive by stage
stage_pos_total <- develop %>%
group_by(stage) %>%
mutate(total_pos=sum(positive_status)) %>%
mutate(total_ind=sum(singles)) %>%
ungroup()
#Prevalence by stage from scratch
prev_stage <- stage_pos_total %>%
group_by(stage) %>%
mutate(prevalence=((sum(positive_status)/(sum(singles)))*100))
#model
species_site_model <- brm(average_virus ~ 1+ site*species,
family=hurdle_gamma(link="log"),
data=site_based_pos,
prior=c(prior(normal(0, 0.5), class="b"),
prior(normal(0.5, 0.8), class="Intercept")),
sample_prior="only",
iter=1000, chains=4,
file="Models/species_site_model.rds",
file_refit="on_change")
species_site_model <- update(species_site_model, iter=2000, chains=4)#update chains and iterations
species_site_model#call the model to view stats
species_site_model#call the model to view stats
saveRDS(species_site_model, "Models/species_site_model.rds")
#Conditional effects plot
plot(conditional_effects(species_site_model))
#model
species_site_model <- brm(average_virus ~ 1+ site*species,
family=hurdle_gamma(link="log"),
data=site_based_pos,
prior=c(prior(normal(0, 0.5), class="b"),
prior(normal(0.5, 0.8), class="Intercept")),
#sample_prior="only",
iter=1000, chains=4,
file="Models/species_site_model.rds",
file_refit="on_change")
saveRDS(species_site_model, "Models/species_site_model.rds")
species_site_model <- update(species_site_model, iter=2000, chains=4)#update chains and iterations
species_site_model#call the model to view stats
saveRDS(species_site_model, "Models/species_site_model.rds")
#Conditional effects plot
plot(conditional_effects(species_site_model))
#Data for plotting
cond_data_site <- distinct(species_site_model$data %>% select(-virus))
#Data for plotting
cond_data_site <- distinct(species_site_model$data %>% select(-average_virus))
posts_site <- add_epred_draws(species_site_model, newdata=cond_data_site)
#Plot looking at the average copies of ranavirus on the log scale based on species, colored by site
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
species_site_plot
#Plot looking at the average copies of ranavirus on the log scale based on species, colored by site
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=average_virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
species_site_plot
species_site_plot
#Plot looking at the average copies of ranavirus on the log scale based on species, colored by site
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=average_virus),
position=position_dodge(width=0.9))+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
species_site_plot
#Plot looking at the average copies of ranavirus on the log scale based on species, colored by site
species_site_plot <- posts_site %>%
ggplot(aes(x=site, y=.epred, fill=species))+
geom_violin()+
geom_boxplot(width=0.1,aes(fill=species), position=position_dodge(width=0.9), outlier.size=0)+
geom_point(data=species_site_model$data, aes(y=average_virus),
position=position_dodge(width=0.9))+
scale_y_log10()+
labs(y="Average Ranavirus Copies", x="Site")+
theme(axis.text.x=element_text(size=8, angle=30, hjust=1))+
guides(fill=guide_legend(title="Species"))
species_site_plot
